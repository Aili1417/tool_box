<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>色调工具</title>
    <link rel="Shortcut Icon" href="img/color.ico" type="image/x-icon" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f6f9fc 0%, #edf1f7 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #24C6DC, #514A9D);
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(36, 198, 220, 0.2);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 45%, rgba(255,255,255,0.1) 50%, transparent 55%);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .header-content {
            text-align: center;
        }

        .header-content h1 {
            color: white;
            font-size: 2.4em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            letter-spacing: 1px;
        }

        .back-link {
            position: absolute;
            top: 15px;
            left: 15px;
            display: inline-flex;
            align-items: center;
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 6px;
            font-size: 14px;
            z-index: 1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .back-link:hover {
            color: #fff;
            transform: translateX(-5px);
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.15);
        }

        .back-link::before {
            content: '←';
            margin-right: 6px;
            transition: transform 0.3s ease;
            display: inline-block;
            font-size: 14px;
        }

        .back-link:hover::before {
            transform: translateX(-5px);
        }

        .tools-nav {
            background: white;
            padding: 12px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tool-button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: #f8f9fa;
            color: #514A9D;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 15px;
            white-space: nowrap;
            min-width: 100px;
        }

        .tool-button.active {
            background: linear-gradient(135deg, #24C6DC, #514A9D);
            color: white;
            box-shadow: 0 4px 12px rgba(36, 198, 220, 0.2);
        }

        .tool-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .tool-content {
            display: none;
            animation: fadeSlideUp 0.5s ease;
            background: #fff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            max-width: 800px;
            margin: 0 auto;
        }

        .tool-content:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        @keyframes fadeSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tool-content.active {
            display: block;
        }

        /* 颜色选择器样式 */
        .color-picker {
            display: flex;
            flex-direction: column;
            gap: 25px;
            padding: 25px;
            max-width: 700px;
            margin: 0 auto;
        }

        .color-wheel-container {
            position: relative;
            width: 350px;
            height: 350px;
            margin: 0 auto;
            padding: 20px;
        }

        #colorWheel {
            width: 310px;
            height: 310px;
        }

        .color-preview {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 180px;
            border-radius: 12px;
            border: 3px solid white;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            background-color: #000000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: monospace;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            gap: 8px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .color-preview:hover {
            transform: translate(-50%, -50%) scale(1.05);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.25);
        }

        .color-preview .hex-value {
            font-size: 20px;
        }

        .color-preview .rgb-value {
            font-size: 16px;
        }

        .color-inputs {
            display: flex;
            gap: 20px;
            padding: 20px;
        }

        .color-input-group {
            flex: 1;
            max-width: 200px;
        }

        .color-input-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 15px;
            color: #514A9D;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .color-input-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-family: monospace;
            font-size: 16px;
            text-align: center;
            transition: all 0.3s ease;
            color: #514A9D;
            background: #f8f9fa;
        }

        .color-input-group input:hover {
            border-color: #24C6DC;
            background: white;
        }

        .color-input-group input:focus {
            outline: none;
            border-color: #24C6DC;
            background: white;
            box-shadow: 0 0 0 4px rgba(36, 198, 220, 0.15);
        }

        /* 调色板生成器样式 */
        .palette-generator {
            max-width: 900px;
            margin: 0 auto;
            padding: 25px;
        }

        .palette-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .palette-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .palette-color {
            position: relative;
            height: 180px;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .palette-color:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .color-codes {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
            font-family: monospace;
            color: white;
            transition: all 0.3s ease;
        }

        .palette-color:hover .color-codes {
            padding: 12px;
        }

        .color-codes div {
            margin: 2px 0;
        }

        .generate-btn {
            background: linear-gradient(135deg, #24C6DC, #514A9D);
            color: white;
            padding: 15px 35px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 18px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(36, 198, 220, 0.2);
            min-width: 250px;
            text-align: center;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(36, 198, 220, 0.3);
        }

        .copy-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #24C6DC, #514A9D);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            display: none;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 15px rgba(36, 198, 220, 0.3);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* 移除 HSL 输入组 */
        #hslInput {
            display: none;
        }

        /* 修改移动端适配样式 */
        @media screen and (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .header-content h1 {
                font-size: 2em;
            }

            .tool-button {
                padding: 10px 15px;
                font-size: 14px;
                min-width: 90px;
            }

            .tool-content {
                padding: 15px;
            }

            .color-picker {
                padding: 15px;
                gap: 15px;
            }

            .color-wheel-container {
                width: 300px;  /* 增加宽度，原来是240px */
                height: 300px;  /* 增加高度，原来是240px */
                padding: 15px;  /* 增加内边距，原来是10px */
            }

            #colorWheel {
                width: 270px;  /* 增加宽度，原来是220px */
                height: 270px;  /* 增加高度，原来是220px */
            }

            .color-preview {
                width: 150px;  /* 增加宽度，原来是120px */
                height: 150px;  /* 增加高度，原来是120px */
            }

            .color-preview .hex-value {
                font-size: 20px;  /* 增加字体大小，原来是18px */
            }

            .color-preview .rgb-value {
                font-size: 16px;  /* 增加字体大小，原来是15px */
            }

            .color-inputs {
                padding: 15px;
                gap: 12px;  /* 增加间距，原来是10px */
            }

            .color-input-group input {
                padding: 15px;  /* 增加内边距，原来是12px */
                font-size: 16px;  /* 增加字体大小，原来是14px */
            }

            .palette-generator {
                padding: 15px;
            }

            .palette-display {
                grid-template-columns: repeat(2, 1fr);  /* 确保移动端显示2列 */
                gap: 12px;
            }

            .palette-color {
                height: 160px;  /* 增加高度，原来是150px */
            }

            .generate-btn {
                padding: 15px 30px;  /* 增加内边距 */
                font-size: 16px;
                min-width: 220px;  /* 增加最小宽度，原来是200px */
            }

            /* 更小屏幕的优化 */
            @media screen and (max-width: 360px) {
                .color-wheel-container {
                    width: 260px;  /* 更小屏幕减小尺寸 */
                    height: 260px;
                }

                #colorWheel {
                    width: 230px;
                    height: 230px;
                }

                .color-preview {
                    width: 130px;
                    height: 130px;
                }
            }
        }

        /* 页面加载动画 */
        .page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }

        .page-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <!-- 在 body 开始处添加加载动画 -->
    <div class="page-loader">
        <div class="loader-content">
            <svg width="50" height="50" viewBox="0 0 50 50">
                <circle cx="25" cy="25" r="20" fill="none" stroke="#24C6DC" stroke-width="5">
                    <animate attributeName="stroke-dasharray" from="0 150" to="125 150" dur="1.5s" repeatCount="indefinite"/>
                    <animate attributeName="stroke-dashoffset" from="0" to="-125" dur="1.5s" repeatCount="indefinite"/>
                </circle>
            </svg>
        </div>
    </div>

    <header>
        <div class="container">
            <div class="header-content">
                <h1>色调工具</h1>
            </div>
        </div>
    </header>

    <div class="container">
        <a href="index.html" class="back-link">返回首页</a>
        
        <div class="tools-nav">
            <button class="tool-button" onclick="switchTool('picker')">颜色选择器</button>
            <button class="tool-button" onclick="switchTool('palette')">调色板生成器</button>
        </div>

        <!-- 颜色选择器 -->
        <div id="picker-tool" class="tool-content">
            <div class="color-picker">
                <div class="color-wheel-container">
                    <canvas id="colorWheel" width="250" height="250"></canvas>
                    <div class="color-preview" id="colorPreview">
                        <div class="hex-value">#000000</div>
                        <div class="rgb-value">rgb(0, 0, 0)</div>
                    </div>
                </div>
                <div class="color-inputs">
                    <div class="color-input-group">
                        <label>HEX</label>
                        <input type="text" id="hexInput" value="#000000" oninput="updateFromHex(this.value)">
                    </div>
                    <div class="color-input-group">
                        <label>RGB</label>
                        <input type="text" id="rgbInput" value="rgb(0, 0, 0)" oninput="updateFromRGB(this.value)">
                    </div>
                </div>
            </div>
        </div>

        <!-- 调色板生成器 -->
        <div id="palette-tool" class="tool-content">
            <div class="palette-generator">
                <div class="palette-controls">
                    <button class="generate-btn" onclick="generatePalette()">生成新配色</button>
                </div>
                <div class="palette-display" id="paletteDisplay"></div>
            </div>
        </div>
    </div>

    <div class="copy-message" id="copyMessage">颜色代码已复制到剪贴板</div>

    <script>
        // 工具切换功能
        function switchTool(toolId) {
            document.querySelectorAll('.tool-content').forEach(tool => {
                tool.classList.remove('active');
            });
            document.querySelectorAll('.tool-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`${toolId}-tool`).classList.add('active');
            event.target.classList.add('active');
        }

        // 颜色轮绘制和交互
        class ColorWheel {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.radius = canvas.width / 2;
                this.centerX = this.radius;
                this.centerY = this.radius;
                this.drawColorWheel();
                this.setupEventListeners();
            }

            drawColorWheel() {
                for(let angle = 0; angle < 360; angle++) {
                    for(let saturation = 0; saturation < 100; saturation++) {
                        const startAngle = (angle - 0.5) * Math.PI / 180;
                        const endAngle = (angle + 0.5) * Math.PI / 180;
                        
                        const radius = saturation * this.radius / 100;
                        
                        this.ctx.beginPath();
                        this.ctx.moveTo(this.centerX, this.centerY);
                        this.ctx.arc(this.centerX, this.centerY, radius, startAngle, endAngle);
                        this.ctx.closePath();
                        
                        const hue = angle;
                        const lightness = 50;
                        this.ctx.fillStyle = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                        this.ctx.fill();
                    }
                }
            }

            setupEventListeners() {
                let isSelecting = false;

                const getColorFromPoint = (x, y) => {
                    const dx = x - this.centerX;
                    const dy = y - this.centerY;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if(distance <= this.radius) {
                        const angle = Math.atan2(dy, dx);
                        const hue = ((angle * 180 / Math.PI) + 360) % 360;
                        const saturation = (distance / this.radius) * 100;
                        const rgb = hslToRGB(hue, saturation, 50);
                        const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                        updateColor(hex);
                    }
                };

                this.canvas.addEventListener('mousedown', (e) => {
                    isSelecting = true;
                    const rect = this.canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    getColorFromPoint(x, y);
                });

                this.canvas.addEventListener('mousemove', (e) => {
                    if(isSelecting) {
                        const rect = this.canvas.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const y = e.clientY - rect.top;
                        getColorFromPoint(x, y);
                    }
                });

                this.canvas.addEventListener('mouseup', () => {
                    isSelecting = false;
                });

                this.canvas.addEventListener('mouseleave', () => {
                    isSelecting = false;
                });
            }
        }

        // 调色板生成功能
        function generatePalette() {
            const paletteDisplay = document.getElementById('paletteDisplay');
            paletteDisplay.innerHTML = '';
            
            // 生成6个和谐的颜色
            const baseHue = Math.random() * 360;
            const colors = [];
            
            // 生成6种和谐色
            for(let i = 0; i < 6; i++) {
                const hue = (baseHue + i * 60) % 360;  // 每隔60度取一个颜色
                const saturation = 65 + Math.random() * 25;  // 65-90%的饱和度
                const lightness = 40 + Math.random() * 30;   // 40-70%的亮度
                
                // 转换 HSL 到 RGB 和 HEX
                const rgb = hslToRGB(hue, saturation, lightness);
                const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                
                colors.push({
                    hex: hex,
                    rgb: `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`
                });
            }
            
            colors.forEach(color => {
                const colorDiv = document.createElement('div');
                colorDiv.className = 'palette-color';
                colorDiv.style.backgroundColor = color.hex;
                
                const codeContainer = document.createElement('div');
                codeContainer.className = 'color-codes';
                codeContainer.innerHTML = `
                    <div>${color.hex}</div>
                    <div>${color.rgb}</div>
                `;
                
                colorDiv.appendChild(codeContainer);
                colorDiv.onclick = () => copyToClipboard(color.hex);
                paletteDisplay.appendChild(colorDiv);
            });
        }

        // 辅助函数
        function hexToRGB(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        function hslToRGB(h, s, l) {
            s /= 100;
            l /= 100;
            const k = n => (n + h / 30) % 12;
            const a = s * Math.min(l, 1 - l);
            const f = n =>
                l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));
            return {
                r: Math.round(255 * f(0)),
                g: Math.round(255 * f(8)),
                b: Math.round(255 * f(4))
            };
        }

        function rgbToHex(r, g, b) {
            const toHex = x => {
                const hex = x.toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            };
            return `#${toHex(r)}${toHex(g)}${toHex(b)}`.toUpperCase();
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                const message = document.getElementById('copyMessage');
                message.style.display = 'block';
                setTimeout(() => {
                    message.style.display = 'none';
                }, 2000);
            });
        }

        // 初始化
        window.onload = function() {
            const canvas = document.getElementById('colorWheel');
            new ColorWheel(canvas);
            
            const pickerButton = document.querySelector('button[onclick="switchTool(\'picker\')"]');
            pickerButton.classList.add('active');
            document.getElementById('picker-tool').classList.add('active');
            generatePalette();
        }

        // 更新颜色显示
        function updateColor(color) {
            const preview = document.getElementById('colorPreview');
            const rgb = hexToRGB(color);
            
            // 更新背景色
            preview.style.backgroundColor = color;
            
            // 更新显示的值
            preview.querySelector('.hex-value').textContent = color.toUpperCase();
            preview.querySelector('.rgb-value').textContent = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
            
            // 根据背景色的亮度调整文字颜色
            const brightness = (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
            const textColor = brightness > 128 ? '#000000' : '#FFFFFF';
            preview.style.color = textColor;
            
            // 更新输入框
            document.getElementById('hexInput').value = color.toUpperCase();
            document.getElementById('rgbInput').value = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
        }

        // 在 script 标签末尾添加页面加载动画控制
        window.addEventListener('load', function() {
            const loader = document.querySelector('.page-loader');
            loader.classList.add('hidden');
            setTimeout(() => {
                loader.style.display = 'none';
            }, 500);
        });
    </script>
</body>
</html> 